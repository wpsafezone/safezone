<?php

/**
 * Provide a admin area view for the plugin
 *
 * This file is used to markup the admin-facing aspects of the plugin.
 *
 * @link       https://brunos.digital
 * @since      1.0.0
 *
 * @package    Safezone
 * @subpackage Safezone/admin/partials
 */
if (!defined('WPINC')) {
    die;
}
?>

<div class="app">
    <?php include_once SAFEZONE_PLUGIN_PATH . 'admin/components/safezone-heading.php'; ?>
    <div class="app__body">
        <div class="app__body-main">
            <div class="foundation">
                <div class="foundation-panel">
                    <div class="foundation-panel__heading">
                        <div class="foundation-panel__avatar">
                            <svg class="icon">
                                <use xlink:href="<?php echo esc_url(SAFEZONE_PLUGIN_URL . 'admin/images/icons.svg#shield-alt'); ?>"></use>
                            </svg>
                        </div>
                        <?php if ($this->malware_score == 5): ?>
                            <div class="foundation-panel__content">
                                <div class="foundation-panel__content-title">
                                    Everything looks great!
                                </div>
                                <div class="foundation-panel__content-text">Everything was perfect at your last scan.
                                </div>
                            </div>
                        <?php else: ?>
                            <div class="foundation-panel__content">
                                <div class="foundation-panel__content-title">
                                    Malware detected!
                                </div>
                                <div class="foundation-panel__content-text">We found some malware on your website.
                                    Please scan your website now.
                                </div>
                            </div>
                        <?php endif; ?>
                    </div>
                    <div class="foundation-panel__actions">
                        <div class="foundation-panel__actions-scanner">
                              <span>
                                <button class="btn btn-blue-40 btn-icon run-scanner" type="button">
                                  Scan Now
                                  <svg class="icon">
                                    <use xlink:href="<?php echo esc_url(SAFEZONE_PLUGIN_URL . 'admin/images/icons.svg#loading'); ?>"></use>
                                  </svg>
                                </button>
                                <span>Last scan: <b><?php echo $this->last_malware_scan ? esc_html($this->last_malware_scan) : esc_html('Never'); ?></b></span>
                              </span>
                            <a href="<?php echo esc_url(admin_url('admin.php?page=safezone-settings&tab=malware')); ?>"
                               class="btn btn-white btn-icon">
                                Settings
                                <svg class="icon">
                                    <use xlink:href="<?php echo esc_url(SAFEZONE_PLUGIN_URL . 'admin/images/icons.svg#admin-tools'); ?>"></use>
                                </svg>
                            </a>
                        </div>

                    </div>

                </div>

                <div class="foundation-status">
                    <div class="foundation-status__list">

                        <?php foreach ($this->malware_steps as $step) : ?>

                            <div data-result="<?php echo $step['status'] === 'success' ? esc_attr('success') : esc_attr('failed'); ?>"
                                 class="foundation-status__item <?php echo $step['status'] === 'success' ? esc_attr('status-good-result') : esc_attr('status-bad-result'); ?> "
                                 title="<?php echo esc_attr($step['name']); ?>">
                                <div class="foundation-status__item-container">
                                    <div class="foundation-status__item-number">
                                        <?php echo esc_html($step['step']); ?>
                                    </div>

                                    <div class="foundation-status__item-icon foundation-status__item-icon--success">
                                        <svg class="icon">
                                            <use xlink:href="<?php echo esc_url(SAFEZONE_PLUGIN_URL . 'admin/images/icons.svg#yes'); ?>"></use>
                                        </svg>
                                    </div>

                                    <div class="foundation-status__item-icon foundation-status__item-icon--failed">
                                        <svg class="icon">
                                            <use xlink:href="<?php echo esc_url(SAFEZONE_PLUGIN_URL . 'admin/images/icons.svg#info-outline'); ?>"></use>
                                        </svg>
                                    </div>

                                    <div class="foundation-status__item-icon foundation-status__item-icon--loading">
                                        <svg class="icon">
                                            <use xlink:href="<?php echo esc_url(SAFEZONE_PLUGIN_URL . 'admin/images/icons.svg#loading-2'); ?>"></use>
                                        </svg>
                                    </div>
                                </div>
                                <div class="foundation-status__item-text">
                                    <?php echo esc_html($step['name']); ?>
                                </div>
                                <?php if (!$this->is_pro): ?>
                                    <?php if ($step['step'] === 2 || $step['step'] === 7) : ?>
                                        <a href="/" class="foundation-status__item-badge">PRO</a>
                                    <?php endif; ?>
                                <?php endif; ?>
                            </div>
                        <?php endforeach; ?>

                    </div>
                </div>

                <div class="foundation-table">

                    <div class="table">
                        <div class="table-container">
                            <table id="malwareTable" class="table-main">
                                <thead class="table-head">
                                <tr>
                                    <th>Results</th>
                                    <th>State</th>
                                    <th>Found Date</th>
                                    <th>Actions</th>
                                </tr>
                                </thead>
                                <tbody class="table-body"></tbody>
                            </table>
                        </div>
                    </div>
                </div>
                <?php include_once SAFEZONE_PLUGIN_PATH . 'admin/components/safezone-footer-bottom-bar.php'; ?>
            </div>
        </div>
        <div class="app__body-sidebar">
            <div class="sidebar">
                <?php include_once SAFEZONE_PLUGIN_PATH . 'admin/components/safezone-sidebar-malware-report.php'; ?>
                <?php include_once SAFEZONE_PLUGIN_PATH . 'admin/components/safezone-sidebar-upgrade.php'; ?>
                <?php include_once SAFEZONE_PLUGIN_PATH . 'admin/components/safezone-sidebar-documentation.php'; ?>
                <?php include_once SAFEZONE_PLUGIN_PATH . 'admin/components/safezone-sidebar-guidance.php'; ?>
            </div>
        </div>
    </div>
</div>